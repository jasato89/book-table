{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { trigger, state, style, animate, transition } from '@angular/animations';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../../services/auth.service\";\nimport * as i2 from \"./../../services/toast.service\";\nimport * as i3 from \"@ionic/angular\";\n\nfunction AnimatedLikeComponent_ion_icon_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-icon\", 1);\n    i0.ɵɵlistener(\"click\", function AnimatedLikeComponent_ion_icon_0_Template_ion_icon_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleLikeState());\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"@heart\", ctx_r0.likeState)(\"src\", ctx_r0.iconName);\n  }\n}\n\nexport let AnimatedLikeComponent = /*#__PURE__*/(() => {\n  class AnimatedLikeComponent {\n    constructor(authService, toastService) {\n      this.authService = authService;\n      this.toastService = toastService;\n      this.postData = {\n        id_user: '',\n        id_rest: ''\n      };\n    }\n\n    ngOnInit() {\n      this.getState();\n    }\n\n    ionViewDidLeave() {}\n\n    ngOnDestroy() {\n      this.postData = null;\n      this.likeState = null;\n      this.iconName = null;\n    }\n\n    getState() {\n      if (this.like) {\n        this.likeState = 'liked';\n        this.iconName = \"assets/icon/heart_green.svg\";\n      } else {\n        this.likeState = 'unliked';\n        this.iconName = \"assets/icon/heart_empty.svg\";\n      }\n    }\n\n    getStatePetition() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.postData = {\n          id_rest: this.id_rest,\n          id_user: window.localStorage.getItem('id_user')\n        };\n        this.authService.getOneLike(this.postData).subscribe(res => {\n          if (res) {\n            this.likeState = 'liked';\n            this.iconName = \"assets/icon/heart_green.svg\";\n          } else {\n            this.likeState = 'unliked';\n            this.iconName = \"assets/icon/heart_empty.svg\";\n          }\n        }, error => {\n          this.toastService.presentToast('Problème de réseau.');\n        });\n      });\n    }\n\n    setLike() {\n      this.postData = {\n        id_rest: this.id_rest,\n        id_user: window.localStorage.getItem('id_user')\n      };\n      this.authService.setLikeRestaurant(this.postData).subscribe(res => {\n        if (res) {\n          this.toastService.presentToast('Ajouté aux favoris');\n        } else {\n          this.toastService.presentToast('Retiré de vos envies. ☹️');\n        }\n      }, error => {\n        this.toastService.presentToast('Problème de réseau.');\n      });\n    }\n\n    toggleLikeState() {\n      this.setLike();\n\n      if (this.likeState == 'unliked') {\n        this.likeState = 'liked';\n        this.iconName = \"assets/icon/heart_green.svg\";\n      } else {\n        this.likeState = 'unliked';\n        this.iconName = \"assets/icon/heart_empty.svg\";\n      }\n    }\n\n  }\n\n  AnimatedLikeComponent.ɵfac = function AnimatedLikeComponent_Factory(t) {\n    return new (t || AnimatedLikeComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.ToastService));\n  };\n\n  AnimatedLikeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AnimatedLikeComponent,\n    selectors: [[\"app-animated-like\"]],\n    inputs: {\n      id_user: \"id_user\",\n      id_rest: \"id_rest\",\n      like: \"like\"\n    },\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"heart-like\", \"tappable\", \"\", \"size\", \"large\", 3, \"src\", \"click\", 4, \"ngIf\"], [\"tappable\", \"\", \"size\", \"large\", 1, \"heart-like\", 3, \"src\", \"click\"]],\n    template: function AnimatedLikeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, AnimatedLikeComponent_ion_icon_0_Template, 1, 2, \"ion-icon\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.likeState);\n      }\n    },\n    dependencies: [i3.IonIcon],\n    styles: [\"ion-icon[_ngcontent-%COMP%]{position:absolute;right:10px;top:5px;width:20px}\"],\n    data: {\n      animation: [trigger('heart', [state('unliked', style({\n        color: '#fff',\n        opacity: '0.8',\n        transform: 'scale(1)'\n      })), state('liked', style({\n        color: '#e74c3c',\n        opacity: '1',\n        transform: 'scale(1.1)'\n      })), transition('unliked <=> liked', animate('100ms ease-out'))])]\n    }\n  });\n  return AnimatedLikeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}